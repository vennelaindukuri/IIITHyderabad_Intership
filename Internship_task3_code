# Internship Task 3 â€” Video Frame Extraction using FFmpeg
# Author: Vennela Indukuri
# Date: November 2025

# ------------------------------------------------------------
# Importing required libraries
# ------------------------------------------------------------
import os
import requests
import subprocess

# ------------------------------------------------------------
# Step 1: Download a sample video
# We'll use a small demo video for this task.
# ------------------------------------------------------------
video_url = "https://sample-videos.com/video123/mp4/240/big_buck_bunny_240p_1mb.mp4"
video_path = "input_video.mp4"

print("ðŸŽ¬ Downloading sample video...")

response = requests.get(video_url, stream=True)
with open(video_path, "wb") as f:
    for chunk in response.iter_content(chunk_size=8192):
        f.write(chunk)

print("âœ… Download complete! Saved as", video_path)

# ------------------------------------------------------------
# Step 2: Create an output folder to store extracted frames
# ------------------------------------------------------------
output_folder = "frames"
os.makedirs(output_folder, exist_ok=True)

# ------------------------------------------------------------
# Step 3: Extract frames using FFmpeg
# FFmpeg command explained:
#   -i input_video.mp4   â†’ input video file
#   frames/output_%03d.jpg â†’ output frame filenames (001, 002, 003, etc.)
#   -vf fps=2 â†’ extract 2 frames per second of video
# ------------------------------------------------------------
print("ðŸ§© Extracting frames from video...")

command = [
    "ffmpeg",
    "-i", video_path,
    "-vf", "fps=2",
    os.path.join(output_folder, "output_%03d.jpg")
]

# Run the ffmpeg command
subprocess.run(command, check=True)

print(f"âœ… Frame extraction complete! Saved in '{output_folder}/' folder.")

# ------------------------------------------------------------
# Step 4: Summary message
# ------------------------------------------------------------
frame_files = os.listdir(output_folder)
print(f"\nðŸ“¸ Total frames extracted: {len(frame_files)}")
print("ðŸŽ¯ Task complete â€” check the 'frames' folder for your output images.")
